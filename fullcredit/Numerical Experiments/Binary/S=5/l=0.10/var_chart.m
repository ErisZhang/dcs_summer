hold on

xMin = 0;
xMax = 350;
yMin = -20;
yMax = 0;
trueAns =  0.067355681764443305259593866206504;
X = 1:xMax;

TwoLvlMCX = [39.1719,39.1719,39.1719,39.1719,39.1719...
    80.75,80.75,80.75,80.75,80.75,...
    249.5156,249.5156,249.5156,249.5156,249.5156,...
             ];
        
TwoLvlMCY = [0.11536936472134180775572787069905, 0.094878855567515268942813122521329, 0.10540688365677318427682251922306, 0.11880443103692163442364204684054, 0.10949285905646634342591738686679,...
0.10381390567277778980148639220715, 0.11572886232884131707532304744745, 0.094872924049580240057899516159523, 0.12352718606822975233594519295366, 0.10373264582907902597863625260288,...
0.10028402851216165758696519105797, 0.10562778121505037032257234841381, 0.097510140040603252020723346049635, 0.11542887611545178672134426278717, 0.11459706560416917098255140672336,...
];

TwoLvlMCYMean = arrayfun(@(i) mean(TwoLvlMCY((5*i-4):(5*i))), 1:(length(TwoLvlMCY)/5));

OneLvlISX = [59.6406,59.6406,59.6406,59.6406,...
    104.9219,104.9219,104.9219,104.9219,104.9219,...
    251.0469,251.0469,251.0469,251.0469,251.0469,...
            ];
        
OneLvlISY = [0.049553924323254519568315856759, 0.040967345013256710462012932794096, 0.048167308120679097616090302835801, 0.042426376869577120398702163583948, 0.040548597946135737923878394894928,...
             0.043501140345143088361545835596189, 0.043591486965562170619037374308391, 0.042664353841540013367872319349772, 0.047869301477267096889267605774876, 0.043008129812873538422302033268352,...
             0.044335295926189469128964049104979, 0.048219214110780624082952527942325, 0.04787825072098854384261557015634, 0.045906181635175853650299160335635, 0.042237673384319815439447154403751,...
             ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

TwoLvlISX = [91.4688,91.4688,91.4688,91.4688,91.4688,...
    132.0781,132.0781,132.0781,132.0781,132.0781,...
    294.125,294.125,294.125,294.125,294.125,...
            ];
        
TwoLvlISY = [0.031340973583225240073346640201635, 0.032956865697143775117972097632446, 0.029241160499016184692866460181904, 0.024332117466146226114620532143817, 0.034369690516196066409904119609564,...
             0.029968411891886398423778814503748, 0.02742093587332073562068401884062, 0.030063324428545007416246903630963, 0.026255308409288830029382211250777, 0.029103594044392975398460876590434,...
             0.031661953073548666781622529242668, 0.029056341248517938286033412964571, 0.026509273072432643081342007462808, 0.035732722176190320761968166607403, 0.030450364928924243679286831820718,...
         ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

OneLvlISEX = [32.1563,32.1563,32.1563,32.1563,32.1563,...
    69.1094,69.1094,69.1094,69.1094,69.1094,...
    134.4063,134.4063,134.4063,134.4063,134.4063,...
            ];
        
OneLvlISEY = [0.12011349441448174180102625996369, 0.091412232578704677443681703152834, 0.096628239031973373052153419848764, 0.089354741193532510878938524001569, 0.080436092877471054851667986440589,...
0.089538223603085137503043711149076, 0.1100929529742701307171159896825, 0.10256152412365086845635886447781, 0.087183005656958842410908516740164, 0.077225487352846927668892362817132,...
 0.098423194776576225506481421234639, 0.068871946743571402227424016473378, 0.10902254399630860459691206187927, 0.091269042226393912176085621013044, 0.09491598286058419708943745263241,...
             ];

OneLvlISEYMean = arrayfun(@(i) mean(OneLvlISEY((5*i-4):(5*i))), 1:(length(OneLvlISEY)/5));

% GISX = [56.9063,56.9063,56.9063,56.9063,56.9063,...
%     107.4688,107.4688,107.4688,107.4688,107.4688,...
%     188.9844,188.9844,188.9844,188.9844,188.9844,...
%             ];
%         
% GISY = [0.000036248616248502811641035714629311, 0.000039329684366322966001996291884879, 0.00035386734921409113488466324781712, 0.009532970239707982615384729285779, 0.000017876832058288794741716942748866,...
% 0.00010256307661679185010746712114482, 0.00051491356483848759514193593744835, 0.0010229598643830817555205880964309, 0.00016178146446586887064952864356826, 0.0044317992051094703617741821233267,...
% 0.00032216435843321176860434840172331, 0.0009691062131038894215603884951804, 0.045685203026656746871925207642562, 0.00015090881267633269495823111761013, 0.002312094964260192307692332036595,...
%              ];
% 
% GISYMean = arrayfun(@(i) mean(GISY((5*i-4):(5*i))), 1:(length(GISY)/5));

OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCYMean) .* 100;

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCYMean) .* 100;

OneLvlISERatio = (OneLvlISEYMean ./ TwoLvlMCYMean) .* 100;

% GISRatio = (GISYMean ./ TwoLvlMCYMean) .* 100;

%s1 = scatter(TwoLvlMCX,TwoLvlMCY,'r', 'filled');
%s2 = scatter(OneLvlISX,OneLvlISY,'g', 'filled');
%s3 = scatter(TwoLvlISX,TwoLvlISY,'b', 'filled');
%alpha(s1,0.4);
%alpha(s2,0.4);
%alpha(s3,0.4);

plot(unique(TwoLvlMCX),log10(TwoLvlMCYMean),'r','LineWidth',3)
plot(unique(OneLvlISX),log10(OneLvlISYMean),'g','LineWidth',3)
plot(unique(OneLvlISEX),log10(OneLvlISEYMean),'black','LineWidth',3)
plot(unique(TwoLvlISX),log10(TwoLvlISYMean),'b','LineWidth',3)
% plot(unique(GISX),log(GISYMean),'y','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

% r1 = refline(0,log(trueAns));
% r1.Color = 'r';
% r1.LineStyle = '--';

%legend('2LvlMC','1LvlISZ','1LvlISE','2LvlIS','GlassermanIS');
legend('2LvlMC','1LvlISZ','1LvlISE','2LvlIS');
xlabel('Runtime (Seconds)');
ylabel('log(Varience)');


hold off
