hold on

xMin = 0;
xMax = 4500;
yMin = -20;
yMax = 0;
TwoLvlMCVar = 0.0079838794695612988472355198155128;
X = 1:xMax;

OneLvlISX = [600,600,600,600,600,...
    1200,1200,1200,1200,1200,...
    1800,1800,1800,1800,1800,...
    2400,2400,2400,2400,2400,...
    3000,3000,3000,3000,3000,...
    3600,3600,3600,3600,3600,...
    4200,4200,4200,4200,4200
             ];
      
OneLvlISY = [0.00056878031689221999686600916845691, 0.00065325289585038530133093148677403, 0.0006741402966588267830355674092857, 0.00063378892559478889473512097652019, 0.00080759380842911499681635589809048,...
    0.00055605212090066265858551153300482, 0.00064448670532183825656463715958466, 0.00065118434387338708629194838906074, 0.0006034259237235648594063763816564, 0.00067041595294043993414484505777295,...
    0.00070819926029411781661510039143081, 0.00054005766852593180705338626879097, 0.00053458418521487691306426359716397, 0.00068668938646636052541838424190246, 0.00053889929049458261747784781903192,...
    0.00059358217292587560093980458830742, 0.00061421448755358287220629254221649, 0.00053751667613190614106177811493126, 0.00061405171909949165642145230137317, 0.00062036495299633168196834498431258,...
    0.00052481928996840154864195193695764, 0.00051536633782352974167406678418502, 0.00059683714727837787993036666733815, 0.00046157707804669645445042047704476, 0.00062936619468179023830639584602409,...
    0.00057419402488251356907883460323205, 0.00058035518221099982420774221480997, 0.00054963398885026209118170870127074, 0.00049860880661037202191132600148649, 0.00056141312546612379130728243126214,...
    0.00064262156280984182067650412051307, 0.00059552712629542018610978582060511, 0.00061625209322251691280297736241778, 0.00064296155023052417414042292165277, 0.00059821821653570340059091758888599,...
             ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCVar) .* 100;

TwoLvlISX = [600,600,600,600,600,...
    1200,1200,1200,1200,1200,...
    1800,1800,1800,1800,1800,...
    2400,2400,2400,2400,2400,...
    3000,3000,3000,3000,3000,...
    3600,3600,3600,3600,3600,...
    4200,4200,4200,4200,4200
             ];
      
TwoLvlISY = [0.00043480040468063649219260247136276, 0.00039074855065322349227316389708164, 0.00050685980530886648714322673114907, 0.00037766770555116283740806903956866, 0.00046175369927030926811561961642383,...
    0.000389319344731733939842660552344, 0.00037121222946739874590238450480228, 0.00037799537707789598222143934158623, 0.00051246795218748127185431906482904, 0.00040135157141873534052123329018968,...
    0.00030067895968300962497229966707835, 0.00033955999506365405283050962204072, 0.00029490961610405258671793737867972, 0.00031840886736447912737368870494947, 0.0003306563290437099494195605231539,...
    0.00038276297468145905646130788824166, 0.00033258188987877562682246579406353, 0.00030837805292126783951456303611849, 0.00038223887523305971484002818705505, 0.00031813941070827511268734322236185,...
    0.00030958094217265082464390912875274, 0.00037092560518889571832476526047628, 0.00034577069081702095599759050337241, 0.00035343682393175024185338894966435, 0.00032982553822711587832375301765353,...
    0.00033128346562493442154298528556922, 0.00031288173266773690664455109811115, 0.00034184602777535756830407098760816, 0.00031411283707874574624638319697567, 0.00031538806266536014788828823363076,...
    0.00028768538737025699985119797652544, 0.00037784934099471405343287355727, 0.00033232222554950850744795443070245, 0.00028126347209252373134796831877225, 0.00041192113781592977223705576150792,...
             ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCVar) .* 100;

plot(unique(OneLvlISX),log10(OneLvlISYMean),'g','LineWidth',3)
plot(unique(TwoLvlISX),log10(TwoLvlISYMean),'b','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

r1 = refline(0,log10(TwoLvlMCVar));
r1.Color = 'r';
r1.LineStyle = '--';

legend('1LvlISZ','2LvlIS','2lvlMC');
xlabel('Number of samples used to train pi*');
ylabel('log(Varience)');

hold off;
