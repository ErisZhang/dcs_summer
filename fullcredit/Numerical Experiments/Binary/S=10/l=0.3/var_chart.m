hold on

xMin = 0;
xMax = 350;
yMin = -20;
yMax = 0;
trueAns =  0.067355681764443305259593866206504;
X = 1:xMax;

TwoLvlMCX = [33.5156,33.5156,33.5156,33.5156,33.5156,...
    64.5313,64.5313,64.5313,64.5313,64.5313,...
    133.7188,133.7188,133.7188,133.7188,133.7188,...
             ];
 
TwoLvlMCY = [ 0, 0, 0, 0, 0,...
0, 0, 0, 0, 0,...
0, 0, 0, 0.0000079999679998679514003872420557784, 0,...
];

TwoLvlMCYMean = arrayfun(@(i) mean(TwoLvlMCY((5*i-4):(5*i))), 1:(length(TwoLvlMCY)/5));

OneLvlISX = [54.7031,54.7031,54.7031,54.7031,54.7031,...
    86.6563,86.6563,86.6563,86.6563,86.6563,...
    146.5313,146.5313,146.5313,146.5313,146.5313,...
            ];
        
OneLvlISY = [0.000000016200124471036298436628586778011, 0.0000000069563400386204188290954215218281, 0.000000016107232620593698237165450727962, 0.000000025064235263743819309730287750969, 0.00000002851600337865602023134400759552,...
    0.000000022890628218537974718806217206031, 0.000000015155837246370565158127486824445, 0.000000020999577646487805652499624765352, 0.0000000083754610009118808614226212266689, 0.000000014051321669129241881938900530537,...
    0.0000000071854347878826212300613109063268, 0.0000000086127112939560176317263778117406, 0.000000012396689945753396709904530588377, 0.00000013745783058282077027257162948198, 0.000000013143059716666071182016458610432,...
             ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

TwoLvlISX = [94.5,94.5,94.5,94.5,94.5,...
    130.3906,130.3906,130.3906,130.3906,130.3906,...
    184.2344,184.2344,184.2344,184.2344,184.2344,...
            ];
        
TwoLvlISY = [0.0000000035959466912704180179785362929043, 0.0000000015887711334099976397933290424703, 0.00000000099373994333046599342935662721758, 0.0000000071156545361028401735051815511085, 0.0000000027797936731573607899045473101484,...
    0.0000000015001977624042968159962800321909, 0.0000000062510479364380053543867311839285, 0.0000000014377974906894220818216719172638, 0.0000000018478116782247007193750058793072, 0.0000000036976088561517013314422664012598,...
    0.0000000033032218912920524324444029417962, 0.0000000050964043096418137010570814844114, 0.0000000018569476090425285007347369276086, 0.0000000039834184703120479827247100133598, 0.0000000017555187894123697967627656149853,...
         ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

OneLvlISEX = [34.75,34.75,34.75,34.75,34.75,...
    69.9531,69.9531,69.9531,69.9531,69.9531,...
    124.0156,124.0156,124.0156,124.0156,124.0156,...
            ];
        
OneLvlISEY = [0.000000000004706791584477282201976657067719, 0.0000000000000073877236712759006685924924870597, 0.0000000000000023174604637612287529099126478677, 0.00000000000077987904498337744511273318475627, 0.0000000000000059968895702892464867930197845757,...
    0.000000019584543783281190735727774160195, 0.00000000011114872682589253725861525726664, 0.0000000000001559462646251266503238044028392, 0.00000000000000019465906042772315702976053559817, 0.000000000000049113194262380164587864871586423,...
    0.00000022109008608166072334990097554563, 0.0000000000000000012974420802764746562666697233019, 0.0000000000000074429158977463598875487069143341, 0.0000000037457540056644205948968356575945, 0.0000000000078526377232638050960170473395064,...
             ];

OneLvlISEYMean = arrayfun(@(i) mean(OneLvlISEY((5*i-4):(5*i))), 1:(length(OneLvlISEY)/5));

% GISX = [54.4219,54.4219,54.4219,54.4219,54.4219,...
%     101.7813,101.7813,101.7813,101.7813,101.7813,...
%     188.4844,188.4844,188.4844,188.4844,188.4844,...
%             ];
%         
% GISY = [0.0000056643072753456423268532404780018, 0.0000015927274062664580453918972829941, 0.000000062714649810003313813989132569776, 0.00000027008493825847206370040047562764, 0.00077285606050838632097993441405492,...
%     0.00021699709677206827367242081283649, 0.0000010562912423986329184645918677354, 0.00000855172127708505036829556705813, 0.000021361675111311185501277928877606, 0.0000095885752616627566131219870260161,...
%     0.000011272313312641549169876471758744, 0.0000019040819271626825140501489477818, 0.0000023899654174731070805943328183574, 0.00000021689890829859772148497916530868, 0.00000086236220872737388972259107641771
%              ];
% 
% GISYMean = arrayfun(@(i) mean(GISY((5*i-4):(5*i))), 1:(length(GISY)/5));


OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCYMean) .* 100;

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCYMean) .* 100;

OneLvlISERatio = (OneLvlISEYMean ./ TwoLvlMCYMean) .* 100;

% GISRatio = (GISYMean ./ TwoLvlMCYMean) .* 100;

%s1 = scatter(TwoLvlMCX,TwoLvlMCY,'r', 'filled');
%s2 = scatter(OneLvlISX,OneLvlISY,'g', 'filled');
%s3 = scatter(TwoLvlISX,TwoLvlISY,'b', 'filled');
%alpha(s1,0.4);
%alpha(s2,0.4);
%alpha(s3,0.4);

%plot(unique(TwoLvlMCX),log(TwoLvlMCYMean),'r','LineWidth',3)
plot(unique(OneLvlISX),log10(OneLvlISYMean),'g','LineWidth',3)
plot(unique(OneLvlISEX),log10(OneLvlISEYMean),'black','LineWidth',3)
plot(unique(TwoLvlISX),log10(TwoLvlISYMean),'b','LineWidth',3)
% plot(unique(GISX),log(GISYMean),'y','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

% r1 = refline(0,log(trueAns));
% r1.Color = 'r';
% r1.LineStyle = '--';

% legend('1LvlISZ','1LvlISE','2LvlIS','GlassermanIS');
legend('1LvlISZ','1LvlISE','2LvlIS');
xlabel('Runtime (Seconds)');
ylabel('log(Varience)');


hold off
