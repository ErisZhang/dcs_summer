hold on

xMin = 0;
xMax = 350;
yMin = -20;
yMax = 0;
trueAns =  0.067355681764443305259593866206504;
X = 1:xMax;

TwoLvlMCX = [36.4063,36.4063,36.4063,36.4063,36.4063,...
             94.2969,94.2969,94.2969,94.2969,94.2969,...
             220.25,220.25,220.25,220.25,220.25,...   
             ];
 
TwoLvlMCY = [ 0.00022217530812080067670853666950137, 0.00049975555283931203699732126466415, 0.00086592517694657666817853458596232, 0.0015642296025510087510018708556458, 0.00005555308639231248133208418416018,...
0.00017497046856539973753649763743567, 0.000068745703098140642007575495942007, 0.00074944218401435953435391068566673, 0.00031865039000253142943003270559643, 0.00019996124975782715040527326433306,...
0.0025176394945529432037312211889457, 0.0014100118960484408180133808485834, 0.00041183190332727336946741503176384, 0.0016413038292172011864411551584908, 0.0019163212652900992599702689744845,...
];

TwoLvlMCYMean = arrayfun(@(i) mean(TwoLvlMCY((5*i-4):(5*i))), 1:(length(TwoLvlMCY)/5));

OneLvlISX = [61.625,61.625,61.625,61.625,61.625,...
            106.4219,106.4219,106.4219,106.4219,106.4219,...
            230.5781,230.5781,230.5781,230.5781,230.5781,...
            ];
        
OneLvlISY = [0.000050120145516084311251934352293702, 0.000018539627299785700506552441058084, 0.000025399784840982021582147035165811, 0.000055360834096506976605665817370294, 0.00004042071479118395429261725859682,...
    0.000051645788539122681158610728147096, 0.000089213149270439258495951628802345, 0.000031158963640746200859151654460888, 0.000028108385743520038153918719214808, 0.000036102493737824084259289275644633,...
    0.00008429359449315925053268505617865, 0.000062170671666760102366984519495219, 0.000041015150661168991953406393058401, 0.000054527828748105428111492970488783, 0.000057406194248307833457017207434703,...
             ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

TwoLvlISX = [93.4688,93.4688,93.4688,93.4688,93.4688,...
             132.6406,132.6406,132.6406,132.6406,132.6406,...
             304.6875,304.6875,304.6875,304.6875,304.6875,...
            ];
        
TwoLvlISY = [0.000021226631792805876784236210341739, 0.000015291995883789679365211827688498, 0.0000092433196411291332122896896583697, 0.000010642297114862587077655994849401, 0.0000088782296426327045248561714574365,...
    0.0000071407806679326880480089372038588, 0.000010520018609991503867324806609229, 0.000014484267993800952457569310161123, 0.000013607237436750365934751486052257, 0.0000096815961190322065042443422377971,...
     0.0000088324877078728895949798899378536, 0.000015473875488360331421694091047492, 0.000035950048687047841922907048806124, 0.0000062936894656039918673445625330043, 0.0000084972331460387825666615360664657,...
         ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

OneLvlISEX = [34.4688,34.4688,34.4688,34.4688,34.4688,...
    72.7813,72.7813,72.7813,72.7813,72.7813,...
    123,123,123,123,123,...
            ];
        
OneLvlISEY = [ 0.0014679663934382171375236936228248, 0.00084502591035813534592335827255738, 0.0000022011690824099551202401928162722, 0.00007391552066536605941366594452191, 0.000027073938515634825936403973223321,...
    0.00010102051091661271963861173928123, 0.000046879761337809469894793990007997, 0.0023141839042452286463735777743977, 0.000082575364782132548019388806892493, 0.000026135945970803063073467295551744,...
    0.000025518113156252436536566147173843, 0.0000573950057919124634179565414005, 0.000053033408548288155093253237737372, 0.000068184143738111199339185786172379, 0.00011665359613181959020679345773175,...
             ];

OneLvlISEYMean = arrayfun(@(i) mean(OneLvlISEY((5*i-4):(5*i))), 1:(length(OneLvlISEY)/5));

% GISX = [55.4531,55.4531,55.4531,55.4531,55.4531,...
%     106.7031,106.7031,106.7031,106.7031,106.7031,...
%     184.4844,184.4844,184.4844,184.4844,184.4844,...
%             ];
%         
% GISY = [0.00000019952902974473218452957138345505, 0.00013682622976427888600650661921065, 0.0000074059343736773372725680844586016, 0.000002374537156451591790530704362272, 0.00000035096337594733168147300371962627,...
%      0.00000085988386943479837035901429398432, 0.00000023742638994099693878495809049728, 0.00000084242187675639388187703989960275, 0.0000033131633761354723523024756043354, 0.0000002838370015491607413397163409835,...
%      0.00000071615259113520773266475978602319, 0.013556379813163859510138919972633, 0.0000013109882537035704252559135951639, 0.0014896120174850147055423121855711, 0.00000038214450577077328993633653295148,...
%          ];
% 
% GISYMean = arrayfun(@(i) mean(GISY((5*i-4):(5*i))), 1:(length(GISY)/5));

OneLvlISERatio = (OneLvlISEYMean ./ TwoLvlMCYMean) .* 100;

OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCYMean) .* 100;

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCYMean) .* 100;

% GISRatio = (GISYMean ./ TwoLvlMCYMean) .* 100;


plot(unique(TwoLvlMCX),log10(TwoLvlMCYMean),'r','LineWidth',3)
plot(unique(OneLvlISX),log10(OneLvlISYMean),'g','LineWidth',3)
plot(unique(OneLvlISEX),log10(OneLvlISEYMean),'black','LineWidth',3)
plot(unique(TwoLvlISX),log10(TwoLvlISYMean),'b','LineWidth',3)
% plot(unique(GISX),log(GISYMean),'y','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

% r1 = refline(0,log(trueAns));
% r1.Color = 'r';
% r1.LineStyle = '--';

% legend('2LvlMC','1LvlISZ','1LvlISE','2LvlIS','GlassermanIS');
legend('2LvlMC','1LvlISZ','1LvlISE','2LvlIS');
xlabel('Runtime (Seconds)');
ylabel('log(Varience)');


hold off
