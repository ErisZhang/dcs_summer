hold on

xMin = 0;
xMax = 4500;
yMin = -20;
yMax = 0;
TwoLvlMCVar = 0.00010155929583725293696271768650874; % true ans

OneLvlISX = [600,600,600,600,600,...
    1200,1200,1200,1200,1200,...
    1800,1800,1800,1800,1800,...
    2400,2400,2400,2400,2400,...
    3000,3000,3000,3000,3000,...
    3600,3600,3600,3600,3600,...
    4200,4200,4200,4200,4200
             ];
        
OneLvlISY = [0.000028282026642473940652696209885342, 0.0000045098926029503572703786666575621, 0, 0.0000018718922542213710936130112438835, 0.0000022777311312007533479831455913711,...
0.00000070191943135993857964995005019326, 0.0000034318238405837907653496855059361, 0.00000057332472587223841308206977174233, 0, 0.00000080669969526291468183527236940344,...
0.00000064018956575250266827664972699163, 0.0000010234202811983086260725489546886, 0.00000044884752842169575504555111347682, 0.0000016018951055888799586354471343741, 0.00000057152557106135764806184671599221,...
0.00000090893860889050708988046514691383, 0.00000080942472496614477327767697006911, 0, 0.0000015670826412834644716042496737085, 0,...
0.0000022866583205998662549655528475334, 0.0000005544971019337392775639772150853, 0.00000075642116552634244574956868742421, 0.00000052072654344559458395886447634737, 0.00000062194537632794245304743109212242,...
0.0000014058879651303315048668004377808, 0.00000044870318247208009151564883296159, 0.00000086409043556929819588421090928443, 0.00000041163441773661878384109910448962, 0.00000071250774229163035385840700708382,...
0.0000011674011447391435601872401381374, 0.0000015767280587828519977156883913327, 0, 0.00000037832382198276114204079983646678, 0.0000007440608088746779053695989958328,...
];
   
OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCVar) .* 100;

TwoLvlISX = [600,600,600,600,600,...
    1200,1200,1200,1200,1200,...
    1800,1800,1800,1800,1800,...
    2400,2400,2400,2400,2400,...
    3000,3000,3000,3000,3000,...
    3600,3600,3600,3600,3600,...
    4200,4200,4200,4200,4200
             ];
      
TwoLvlISY = [ 0.00000038217857400699073535768374339228, 0.0000020940767002750499829787436678608, 0.00000011804827596124531241436980038076, 0, 0.0000001573379427503491428843289011083,...
    0, 0.000000038800289998316816310773357890165, 0.00000017831701413455755531879112687349, 0.000000071674033027155437262322422182353, 0.000000045520094894609586994335914634721,...
    0.000000076378240437061914643961091624796, 0, 0.000000079980862891934252128370362415477, 0.000000035373021463762422143176886472557, 0,...
    0.00000017917202566083540791483993005057, 0.000000029611606094685866730007239920434, 0, 0, 0.000000024792833249731883971856384531358,...
0.000000048167874838474795483442194438117, 0, 0.000000036917521843389610009810054966004, 0.000000056910897094013202051827925772448, 0,...
    0.000000023651386903511041306363686144432, 0.000000028976226354324565806747936755165, 0.000000028764467661252673585674970776344, 0.000000035122060932421360317663819360437, 0.000000023443273673355516323648370987515,...
    0.000000026783035180852509520822918916844, 0.000000017741281023185601337950324752832, 0.000000023651439160102146406729266238031, 0.000000025331655903352175190975734543446, 0.00000002463107703592416157114573858726,...
             ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCVar) .* 100;

plot(unique(OneLvlISX),log10(OneLvlISYMean),'g','LineWidth',3)
plot(unique(TwoLvlISX),log10(TwoLvlISYMean),'b','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

r1 = refline(0,log10(TwoLvlMCVar));
r1.Color = 'r';
r1.LineStyle = '--';

legend('1LvlISZ','2LvlIS','2lvlMC');
xlabel('Number of samples used to train pi*');
ylabel('log(Varience)');

hold off
