hold on

xMin = 0;
xMax = 4500;
yMin = -35;
yMax = 0;
TwoLvlMCVar = 0.00010155929583725293696271768650874; % true ans
X = 1:xMax;

OneLvlISX = [600,600,600,600,600,...
    1200,1200,1200,1200,1200,...
    1800,1800,1800,1800,1800,...
    2400,2400,2400,2400,2400,...
    3000,3000,3000,3000,3000,...
    3600,3600,3600,3600,3600,...
    4200,4200,4200,4200,4200
             ];
      
OneLvlISY = [0.0000026364941201388476879087768151022, 0.00007213657825793478304329114925153, 0, 0.0000021747804809036751425813278892907, 0.0000026306852615326391674926195113349,...
    0.0000018962146272429429853974280906215, 0.0000016445024519495582244289549542215, 0.0000027818149474812154033781259193647, 0, 0.00000063814258743145548464966712240432,...
    0.0000011058648475210179438078372110565, 0.00000068671246815865026904120377651553, 0.00000063674662492147540727440661184611, 0.00000063726383573198969172975787353397, 0.0000014924904010751205112034331254356,...
    0.00000058316777319496927118398950373734, 0.00000096673290778022432055422829416669, 0, 0.0000018743202705208359446864638947483, 0.00000054795707916672555461184068378855,...
    0.00000050134221857642912162090738717457, 0.00000090052591203991184663530007725729, 0.0000016808724560155238950793187002741, 0.0000031259073139464442916502038422033, 0.00000052568585185181934700792685463688,...
    0.00000069002723719693132360577646905453, 0.0000006089084608480773287524090431333, 0.00000054250726754883710683190862697489, 0, 0,...
    0.0000009037197053479620186160268906217, 0.00000037466067412688373980912876805294, 0.0000008376467492430609737994406070738, 0, 0.00000058020939118966321682664341596869,...
             ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCVar) .* 100;

TwoLvlISX = [600,600,600,600,600,...
    1200,1200,1200,1200,1200,...
    1800,1800,1800,1800,1800,...
    2400,2400,2400,2400,2400,...
    3000,3000,3000,3000,3000,...
    3600,3600,3600,3600,3600,...
    4200,4200,4200,4200,4200
             ];
      
TwoLvlISY = [0.0000005011128384634128272022315746248, 0.00000012152108330314780121342234549264, 0.00000039008176894105266874760622533569, 0.000000038188212175022284528908477971298, 0.00000014628060402052956822104316444988,...
    0.000000047592695988015963238223978186078, 0.00000012589445807781291594000820568272, 0.00000023528044943532087103110381990506, 0.00000009401600871718712639471440383615, 0.000000037068158336020321552958719244289,...
    0.000000040041590380407125997999396053648, 0.000000042251782731702883458516653786621, 0.000000044645792255118873883636446912165, 0, 0.000000028398705067238799158940717819698,...
    0.000000030400565082352373659439867710497, 0.000000084662221552825438198533068625412, 0.000000029704965065773050411580398998644, 0.000000081073815322993957661307337821122, 0.000000058558703458480322539501114822991,...
    0.000000034253015267006255819937863551713, 0.000000027162006270698641189725898990349, 0.000000030173410716095550171631916322804, 0.000000025249589062102271068370649650427, 0.000000023634542567916637908221737804718,...
    0.000000023277429393164833038277442434777, 0.000000023224442289860159072648640400313, 0, 0.000000019468732378373003452005183676506, 0.000000026882400235363421028248772206085,...
    0.000000027031134542121426959948400831936, 0.000000022686379259613246326566049037958, 0, 0.000000024492127351119064799610445496043, 0.000000026128551873426756324217610214823,...
             ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCVar) .* 100;

plot(unique(OneLvlISX),log(OneLvlISYMean),'g','LineWidth',3)
plot(unique(TwoLvlISX),log(TwoLvlISYMean),'b','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

r1 = refline(0,log(TwoLvlMCVar));
r1.Color = 'r';
r1.LineStyle = '--';

legend('1LvlIS','2LvlIS','2lvlMC');
xlabel('Number of samples used to train pi*');
ylabel('ln(Varience)');


hold off
