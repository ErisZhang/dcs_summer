hold on

xMin = 0;
xMax = 350;
yMin = -20;
yMax = 0;
trueAns =  0.067355681764443305259593866206504;
X = 1:xMax;

TwoLvlMCX = [38.75,38.75,38.75,38.75,38.75,...
    93.8438,93.8438,93.8438,93.8438,93.8438,...
    234,234,234,234,234,...
             ];
         
TwoLvlMCY = [0.000022221975305911003951671658929179, 0.000011111111111111794352130331675621, 0, 0.000011111111111113551098462937094524, 0,...
   0.000012499921874516789095372996942768, 0.000068745703098124839760911519714881, 0, 0.0000062500000000010641728926015503465, 0.000012499921874492804510438544174367,...
   0.000019999679998732794244335059241635, 0.000027999327997370123300054089998667, 0.00045179750319029892855968166820446, 0.0000079999679998627963578702523839148, 0,...
];

TwoLvlMCYMean = arrayfun(@(i) mean(TwoLvlMCY((5*i-4):(5*i))), 1:(length(TwoLvlMCY)/5));

OneLvlISX = [67.8594,67.8594,67.8594,67.8594,67.8594,...
    108.4531,108.4531,108.4531,108.4531,108.4531,...
    245.3438,245.3438,245.3438,245.3438,245.3438,...
            ];
      
OneLvlISY = [ 0.000015238968307061120664226173959666, 0, 0.0000018091169912411031439196688538895, 0.0000012512584266492435048940146807839, 0.000001155446697573108920303126996576,...
    0.000028282026642473940652696209885342, 0.0000045098926029503572703786666575621, 0, 0.0000018718922542213710936130112438835, 0.0000022777311312007533479831455913711,...
    0.0000026364941201388476879087768151022, 0.00007213657825793478304329114925153, 0, 0.0000021747804809036751425813278892907, 0.0000026306852615326391674926195113349,...
             ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

TwoLvlISX = [112.7813,112.7813,112.7813,112.7813,112.7813,...
    149.5313,149.5313,149.5313,149.5313,149.5313,...
    277.125,277.125,277.125,277.125,277.125,...
            ];
        
TwoLvlISY = [0.00000025718276320062970092405899361077, 0.000000058177630425512355630487552676441, 0.00000013878495425243781488481035948229, 0.00000011652701624718159168790290866266, 0.00000018986173795111197033242268327607,...
    0.00000038217857400699073535768374339228, 0.0000020940767002750499829787436678608, 0.00000011804827596124531241436980038076, 0, 0.0000001573379427503491428843289011083,...
    0.0000005011128384634128272022315746248, 0.00000012152108330314780121342234549264, 0.00000039008176894105266874760622533569, 0.000000038188212175022284528908477971298, 0.00000014628060402052956822104316444988,...
         ];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

OneLvlISEX = [32.1094,32.1094,32.1094,32.1094,32.1094,...
    69.2344,69.2344,69.2344,69.2344,69.2344,...
    133.1719,133.1719,133.1719,133.1719,133.1719,...
    ];

OneLvlISEY = [0.000000068480402032970774871777335651712, 0.000000054533877739579645565824961251852, 0.000000054260014407474829624090050233381, 0.00000000044279249227797895050589120409404, 0.0000025671098826926476515434150799111,...
    0.000010047926744192763097657597470835, 0.000000011932934401937661302206102813088, 0.00000000017666046418876584390530655820339, 0.000011400471885855915701586497934539, 0.00000011212107312917480287137823521948,...
    0.000000073486156230517141799672437701973, 0.00000135878595875907948952951171534, 0.0000000034904568203537254465391201189994, 0.00000069099349717090631605288884170557, 0.000022118689853076790332014195383792,...
            ];

OneLvlISEYMean = arrayfun(@(i) mean(OneLvlISEY((5*i-4):(5*i))), 1:(length(OneLvlISEY)/5));

% GISX = [57.1563,57.1563,57.1563,57.1563,57.1563,...
%     109.375,109.375,109.375,109.375,109.375...
%     193.6094,193.6094,193.6094,193.6094,193.6094,...
%             ];
%       
% GISY = [ 0.0000000002427128932322345927514047427188, 0.00000000066270388589630751160007832140488, 0.0000000019179014574256737832602167102879, 0.000000023523830111025840960165559029652, 0.00000000054037417636727087797175643352492,...
%     0.00000000071623312873165925674587479172833, 0.000000046155341256845097370712521517994, 0.000000000058168365472409727811583438065158, 0.0000028852825095223132399475506754127, 0.00000001672679121093377700666119561098,...
%     0.0000000023220061854153064908571981492073, 0.00000000075614108808436884916035898056221, 0.000000021285545947334191611983097709541, 0.00000000054669064035264204486351924096527, 0.0000019114152137033808694598340655046,...
%              ];
% 
% GISYMean = arrayfun(@(i) mean(GISY((5*i-4):(5*i))), 1:(length(GISY)/5));

OneLvlISRatio = (OneLvlISYMean ./ TwoLvlMCYMean) .* 100;

TwoLvlISRatio = (TwoLvlISYMean ./ TwoLvlMCYMean) .* 100;

OneLvlISERatio = (OneLvlISEYMean ./ TwoLvlMCYMean) .* 100;

% GISRatio = (GISYMean ./ TwoLvlMCYMean) .* 100;

plot(unique(TwoLvlMCX),log10(TwoLvlMCYMean),'r','LineWidth',3)
plot(unique(OneLvlISX),log10(OneLvlISYMean),'g','LineWidth',3)
plot(unique(OneLvlISEX),log10(OneLvlISEYMean),'black','LineWidth',3)
plot(unique(TwoLvlISX),log10(TwoLvlISYMean),'b','LineWidth',3)
% plot(unique(GISX),log(GISYMean),'y','LineWidth',3)

axis([xMin,xMax,yMin,yMax]);

% r1 = refline(0,log(trueAns));
% r1.Color = 'r';
% r1.LineStyle = '--';

% legend('2LvlMC','1LvlISZ','1LvlISE','2LvlIS','GlassermanIS');
legend('2LvlMC','1LvlISZ','1LvlISE','2LvlIS');
xlabel('Runtime (Seconds)');
ylabel('log(Varience)');


hold off
