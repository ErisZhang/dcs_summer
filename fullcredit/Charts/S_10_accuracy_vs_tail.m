hold on

xMin = 0;
xMax = 0.3;
yMin = 0;
yMax = 0.1;
X = 1:xMax;

TwoLvlMCX = [0.1,0.1,0.1,0.1,0.1,...
             0.1125,0.1125,0.1125,0.1125,0.1125,...
             0.125,0.125,0.125,0.125,0.125,...
             0.15,0.15,0.15,0.15,0.15,...
             0.2,0.2,0.2,0.2,0.2];
        
TwoLvlMCY = [0.078269230769230769230769230769231, 0.076730769230769230769230769230769, 0.084134615384615384615384615384615, 0.082403846153846153846153846153846, 0.079903846153846153846153846153846,...
            0.047403846153846153846153846153846, 0.045673076923076923076923076923077, 0.045192307692307692307692307692308, 0.044230769230769230769230769230769, 0.046634615384615384615384615384615,...
            0.027307692307692307692307692307692, 0.026346153846153846153846153846154, 0.026057692307692307692307692307692, 0.028557692307692307692307692307692, 0.029038461538461538461538461538462,...
            0.0093269230769230769230769230769231, 0.010192307692307692307692307692308, 0.010961538461538461538461538461538, 0.0093269230769230769230769230769231, 0.0083653846153846153846153846153846,...
            0.00086538461538461538461538461538462, 0.00048076923076923076923076923076923, 0.0019230769230769230769230769230769, 0.0019230769230769230769230769230769, 0.0014423076923076923076923076923077];

TwoLvlMCYMean = arrayfun(@(i) mean(TwoLvlMCY((5*i-4):(5*i))), 1:(length(TwoLvlMCY)/5));


TwoLvlISX = [0.1,0.1,0.1,0.1,0.1,...
            0.1125,0.1125,0.1125,0.1125,0.1125,...
            0.125,0.125,0.125,0.125,0.125,...
            0.15,0.15,0.15,0.15,0.15,...
            0.2,0.2,0.2,0.2,0.2];
        
TwoLvlISY = [0.079415806444570122279991153391165, 0.080201167798823108645578372488671, 0.079580930298028970670820569921489, 0.077902701383140315893882643649704, 0.083458564849754265924097751394584,...
            0.047128522604107957183483534890911, 0.047022014531678632542899265445158, 0.048056312267644632485463773718948, 0.046954256535341111489234577902607, 0.047439846584407710516906320208363,...
            0.028003898044596298166908354687621, 0.029013931412198594450568833735815, 0.026413444719345990224779185950865, 0.027884852522515359007915236588815, 0.028195962752404164775033024170625,...
            0.0096157955429347699571884788838361, 0.0097327594230577074707611018311582, 0.0097086013032107523756941702686163, 0.0098422160933834424573207755315707, 0.0097082276006952347019440807684987,...
            0.0010915678499948883780484854000292, 0.0011273525575004157087827261207735, 0.0010079582772550197116573356126423, 0.0011129504752771374447711805188987, 0.0010606202547306989563552503952337];

TwoLvlISYMean = arrayfun(@(i) mean(TwoLvlISY((5*i-4):(5*i))), 1:(length(TwoLvlISY)/5));

OneLvlISX = [0.1,0.1,0.1,0.1,0.1,...
            0.1125,0.1125,0.1125,0.1125,0.1125,...
            0.125,0.125,0.125,0.125,0.125,...
            0.15,0.15,0.15,0.15,0.15,...
            0.2,0.2,0.2,0.2,0.2
            ];
        
OneLvlISY = [0.079019683685950511953244301821542, 0.078144847407797340954616061026172, 0.080029052958545107698817844266159, 0.076893462997835893002473994783941, 0.080592517017206488638692007953068,...
            0.048125484329079933065731466967918, 0.047582914000760492823083325220068, 0.045229439229105591890878201866144, 0.047305182705463508230359082062932, 0.045079510979772773049401024536564,...
            0.02700428850861199409072455068781, 0.02845998865030314323165683276784, 0.029212501222953771856660765138258, 0.027504899560182850815071020633695, 0.026896006316311098921500999381351,...
            0.009375229987549537485902462208287, 0.010290799768221564267078882437545, 0.0094178515691389665109856110802866, 0.0094911753355123792963432549640856, 0.0092718253184266592042961363517861,...
            0.0011125678723388893447826530902489, 0.0010222046603091063023821538635616, 0.0010830921772699846246379440373175, 0.0010302714829106235198963315013998, 0.00096767426333155184131618042897571,...
            ];

OneLvlISYMean = arrayfun(@(i) mean(OneLvlISY((5*i-4):(5*i))), 1:(length(OneLvlISY)/5));

s1 = scatter(TwoLvlMCX,TwoLvlMCY,'r', 'filled');
s2 = scatter(TwoLvlISX,TwoLvlISY,'b', 'filled');
s3 = scatter(OneLvlISX,OneLvlISY,'g', 'filled');
alpha(s1,0.4);
alpha(s2,0.4);
alpha(s3,0.4);

plot(unique(TwoLvlMCX),TwoLvlMCYMean,'r','LineWidth',1)
plot(unique(TwoLvlISX),TwoLvlISYMean,'b','LineWidth',1)
plot(unique(OneLvlISX),OneLvlISYMean,'g','LineWidth',1)


legend('TwoLvlMC','TwoLvlIS','OneLvlIS','E[TwoLvlMC]','E[TwoLvlIS]','E[OneLvlIS]')
title('S:10')
xlabel('x')
ylabel('P(Loss > x)')
axis([xMin,xMax,yMin,yMax])

hold off
